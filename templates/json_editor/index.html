{% extends "base.html" %}

{% block title %}Overview Mapping - LITTERBOX Manager{% endblock %}
{% block head_extra %}
<!-- JSONEditor CSS -->
<link rel="stylesheet"
      href="https://cdn.jsdelivr.net/npm/jsoneditor@10.4.1/dist/jsoneditor.min.css">
<style>
    /* Root editor frame */
    .jsoneditor,
    .jsoneditor-frame {
      background-color: #212529; /* bs-dark body */
      color: #dee2e6;
      border: 1px solid #495057;
      border-radius: 0.375rem;
      font-family: var(--bs-font-sans-serif);
    }

    /* Tree / Code area */
    .jsoneditor-tree,
    .jsoneditor-text {
      background-color: #212529;
      color: #dee2e6;
    }

    /* Input fields (key/value editors) */
    .jsoneditor-frame input,
    .jsoneditor-frame textarea,
    .jsoneditor-frame select {
      background-color: #212529;
      color: #dee2e6;
      border: 1px solid #495057;
      border-radius: 0.375rem;
      padding: 0.375rem 0.75rem;
      font-size: 1rem;
      line-height: 1.5;
    }

    /* Placeholder text */
    .jsoneditor-frame input::placeholder,
    .jsoneditor-frame textarea::placeholder {
      color: #adb5bd;
      opacity: 1;
    }

    /* Focus state (Bootstrap 5 exact) */
    .jsoneditor-frame input:focus,
    .jsoneditor-frame textarea:focus,
    .jsoneditor-frame select:focus {
      background-color: #212529;
      color: #dee2e6;
      border-color: #86b7fe;
      outline: 0;
      box-shadow: 0 0 0 0.25rem rgba(13, 110, 253, 0.25);
    }

    /* Disabled */
    .jsoneditor-frame input:disabled,
    .jsoneditor-frame textarea:disabled,
    .jsoneditor-frame select:disabled {
      background-color: #343a40;
      color: #adb5bd;
    }

    /* Expand / collapse icons */
    .jsoneditor-expandable > .jsoneditor-expand {
      filter: invert(75%);
    }

    /* Buttons inside editor */
    .jsoneditor button {
      background-color: #212529;
      color: #dee2e6;
      border: 1px solid #495057;
      border-radius: 0.375rem;
    }

    .jsoneditor button:hover {
      background-color: #343a40;
    }

    /* Menu bar */
    .jsoneditor-menu {
      background-color: #212529;
      border-bottom: 1px solid #495057;
    }

    .jsoneditor-menu a {
      color: #dee2e6;
    }

    /* Error states */
    .jsoneditor-frame .jsoneditor-error {
      background-color: #842029;
      color: #f8d7da;
    }

    /* Selection highlight */
    .jsoneditor-selection {
      background-color: rgba(13, 110, 253, 0.25);
    }


    .jsoneditor-menu {
        background-color: #36454F; /* charcoal */
        color: #eee; /* text color */
    }

    .jsoneditor-tree {
        background-color: #adb5bd;
        border: none;
    }

    .jsoneditor-tree {
        background-color: #ced4da;
        border: none;
    }

    .jsoneditor-contextmenu,
    .jsoneditor-contextmenu ul {
      background-color: #36454F; /* match li's color */
      color: #eee;               /* text color */
    }

    .jsoneditor-contextmenu li,
    .jsoneditor-contextmenu button {
      background-color: #36454F; /* match li's color */
      color: #eee;
    }

    .jsoneditor-contextmenu li:hover,
    .jsoneditor-contextmenu button:hover {
      background-color: #4a5a65; /* slightly lighter for hover */
      color: #fff;
    }


</style>
{% endblock %}

{% block content %}
<div class="container mt-4">
    {% if config_type == "overview" or config_type == "unified" %}
        {% set config_type = config_type + " mapping" %}
    {% endif %}
    <h1 class="mb-3">{{ config_type.replace('_', ' ') | title }} Editor</h1>
    <div class="card bg-dark text-light">
        <div class="card-body">
            <div id="editor"></div>
            <button class="btn btn-primary mt-3" onclick="save()">Save</button>
            <span id="status" class="ms-3"></span>
        </div>
    </div>
</div>
{% endblock %}

{% block script %}
<script>
    manageApplicationUrlBase = "{{ url_for('applications.manage_application', name='__NAME__') }}"
    config_type = "{{ config_type }}";
</script>
<script src="https://cdn.jsdelivr.net/npm/jsoneditor@10.4.1/dist/jsoneditor.min.js"></script>
<script src="{{ url_for('static', filename='json_editor/editor.js') }}"></script>
{% endblock %}
